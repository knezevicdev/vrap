version: '3'
services:
  header-storybook:
    build:
      context: ../../../../
      dockerfile: ./libs/components/header/docker/Dockerfile
    image: vroom-web-header-components:latest
    container_name: storybook
    user: 'root'
    command: ash -c "yarn workspace @vroom-web/header-components storybook"
    ports:
      - '8080:8080'
    volumes:
      # Setup a volume so source code edits will be reflected outside the container.
      - '../../../../:/www/'
      # Setup volumes for dependencies and built artifacts.
      # This allows the node_modules created during the build to not be overwritten.
      # https://stackoverflow.com/questions/30043872/docker-compose-node-modules-not-present-in-a-volume-after-npm-install-succeeds
      # It also makes sure that the built artifacts are only present on the container,
      # and not copied back to the host machine.
      - '/www/node_modules'
      - '/www/libs/integrations/analytics/dist'
      - '/www/libs/integrations/analytics/node_modules'
      - '/www/libs/networking/deals-v2/dist'
      - '/www/libs/networking/deals-v2/node_modules'
      - '/www/libs/networking/inv-search/dist'
      - '/www/libs/networking/inv-search/node_modules'
      - '/www/libs/ui/dist'
      - '/www/libs/ui/node_modules'
